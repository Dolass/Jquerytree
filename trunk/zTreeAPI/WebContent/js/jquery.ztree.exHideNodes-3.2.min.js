/*
 * JQuery zTree exHideNodes 3.3
 * http://code.google.com/p/jquerytree/
 *
 * Copyright (c) 2010 Hunter.z (baby666.cn)
 *
 * Licensed same as jquery - MIT License
 * http://www.opensource.org/licenses/mit-license.php
 *
 * email: hunter.z@263.net
 * Date: 2012-07-15
 */
(function(g){g.extend(!0,g.fn.zTree.consts,{});g.extend(!0,g.fn.zTree._z,{tools:{},view:{clearOldFirstNode:function(c,b){for(var a=b.getNextNode();a;){if(a.isFirstNode){a.isFirstNode=!1;f.setNodeLineIcos(c,a);break}if(a.isLastNode)break;a=a.getNextNode()}},clearOldLastNode:function(c,b){for(var a=b.getPreNode();a;){if(a.isLastNode){a.isLastNode=!1;f.setNodeLineIcos(c,a);break}if(a.isFirstNode)break;a=a.getPreNode()}},makeDOMNodeMainBefore:function(c,b,a){c.push("<li ",a.isHidden?"style='display:none;' ":
"","id='",a.tId,"' class='level",a.level,"' tabindex='0' hidefocus='true' treenode>")},showNode:function(c,b){b.isHidden=!1;g("#"+b.tId).show()},showNodes:function(c,b,a){if(b&&b.length!=0){var e={},h,k;for(h=0,k=b.length;h<k;h++){var i=b[h];if(!e[i.parentTId]){var g=i.getParentNode();e[i.parentTId]=g===null?d.getRoot(c):i.getParentNode()}f.showNode(c,i,a)}for(var j in e)b=e[j][c.data.key.children],f.setFirstNodeForShow(c,b),f.setLastNodeForShow(c,b)}},hideNode:function(c,b){b.isHidden=!0;b.isFirstNode=
!1;b.isLastNode=!1;g("#"+b.tId).hide()},hideNodes:function(c,b,a){if(b&&b.length!=0){var e={},h,k;for(h=0,k=b.length;h<k;h++){var i=b[h];if((i.isFirstNode||i.isLastNode)&&!e[i.parentTId]){var g=i.getParentNode();e[i.parentTId]=g===null?d.getRoot(c):i.getParentNode()}f.hideNode(c,i,a)}for(var j in e)b=e[j][c.data.key.children],f.setFirstNodeForHide(c,b),f.setLastNodeForHide(c,b)}},setFirstNodeForHide:function(c,b){var a,e,h;for(e=0,h=b.length;e<h;e++){a=b[e];if(a.isFirstNode)break;if(!a.isHidden&&
!a.isFirstNode){a.isFirstNode=!0;f.setNodeLineIcos(c,a);break}else a=null}return a},setFirstNodeForShow:function(c,b){var a,e,h,d,i;for(e=0,h=b.length;e<h;e++)if(a=b[e],!d&&!a.isHidden&&a.isFirstNode){d=a;break}else if(!d&&!a.isHidden&&!a.isFirstNode)a.isFirstNode=!0,d=a,f.setNodeLineIcos(c,a);else if(d&&a.isFirstNode){a.isFirstNode=!1;i=a;f.setNodeLineIcos(c,a);break}return{"new":d,old:i}},setLastNodeForHide:function(c,b){var a,e;for(e=b.length-1;e>=0;e--){a=b[e];if(a.isLastNode)break;if(!a.isHidden&&
!a.isLastNode){a.isLastNode=!0;f.setNodeLineIcos(c,a);break}else a=null}return a},setLastNodeForShow:function(c,b){var a,e,d,g;for(e=b.length-1;e>=0;e--)if(a=b[e],!d&&!a.isHidden&&a.isLastNode){d=a;break}else if(!d&&!a.isHidden&&!a.isLastNode)a.isLastNode=!0,d=a,f.setNodeLineIcos(c,a);else if(d&&a.isLastNode){a.isLastNode=!1;g=a;f.setNodeLineIcos(c,a);break}return{"new":d,old:g}}},event:{},data:{}});var j=g.fn.zTree,m=j._z.tools,f=j._z.view,d=j._z.data;d.exSetting({});d.addInitBind(function(){});
d.addInitCache(function(){});d.addInitNode(function(c,b,a){if(typeof a.isHidden=="string")a.isHidden=m.eqs(a.isHidden,"true");a.isHidden=!!a.isHidden});d.addInitRoot(function(){});d.addBeforeA(function(){});d.addZTreeTools(function(c,b){b.showNodes=function(a,b){f.showNodes(c,a,b)};b.showNode=function(a,b){a&&f.showNodes(c,[a],b)};b.hideNodes=function(a,b){f.hideNodes(c,a,b)};b.hideNode=function(a,b){a&&f.hideNodes(c,[a],b)}});var l=d.initNode;d.tmpHideParent=-1;d.initNode=function(c,b,a,e,h,g,i){if(d.tmpHideParent!==
e){d.tmpHideParent=e;var j=(e?e:d.getRoot(c))[c.data.key.children];d.tmpHideFirstNode=f.setFirstNodeForHide(c,j);d.tmpHideLastNode=f.setLastNodeForHide(c,j);f.setNodeLineIcos(c,d.tmpHideFirstNode);f.setNodeLineIcos(c,d.tmpHideLastNode)}h=d.tmpHideFirstNode===a;g=d.tmpHideLastNode===a;l&&l.apply(d,arguments);g&&f.clearOldLastNode(c,a)}})(jQuery);
