<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
 <HEAD>
  <TITLE> ZTREE DEMO </TITLE>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="style/zTreeStyle.css" type="text/css">
  <style>
	body {
	background-color: white;
	margin:0; padding:0;
	text-align: center;
	}
	div, p, table, th, td {
		list-style:none; 
		margin:0; padding:0; 
		color:#333; font-size:12px; 
		font-family:宋体;
	}

	.tb1, .tb1 td {
		padding: 5px;
		border:1px dashed #EAB221;   
		border-collapse:collapse;  
	}

	.treeContent {
		width:200px; 
		height:400px; 
		overflow:auto;
		border:1px dashed #277327;  

	}

	.selectLi {
		background:blue;
		color:white;
	}

  </style>
  <script type="text/javascript" src="jquery-1.4.2.js"></script>
  <script type="text/javascript" src="jquery-ztree-2.0.js"></script>

  <SCRIPT LANGUAGE="JavaScript">
  <!--
	var zTree1;
	var setting;

		setting = {
			
		};

		var zNodes =[
			{ name:"手机",
				nodes: [
					{ name:"诺基亚"},
					{ name:"三星"},
					{ name:"索爱"},
					{ name:"多普达"}
				]},
			{ name:"电脑",
				nodes: [
					{ name:"硬件"},
					{ name:"整机"},
					{ name:"网络"}
				]},
			{ name:"家电",
				nodes: [
					{ name:"电视"},
					{ name:"冰箱"},
					{ name:"空调"}
				]}
						
		];

	$(document).ready(function(){
		zTree1 = $("#tree1").zTree(setting, zNodes);
		getNodes();

	});

	function zTreeOnClick(event, treeId, treeNode) {
		selectNode("srcList", "demo_srcList_"+treeNode.tId, treeNode.tId);
	}
	
	function expandAll(expandSign) {
		zTree1.expandAll(expandSign);
	}

	function expandNode(expandSign) {
		if (srcLiId) {
			zTree1.expandNode(srcNode, expandSign, $("#sonChk").attr("checked"));
		}
	}

	var addCount = 1;
	function addNode() {
		if (srcLiId) {
			zTree1.addNodes(srcNode, [{ name:"增加" + (addCount++)}]);
			getNodes();

		}
	}
	function removeTreeNode() {
		if (srcNode) {
			if (srcNode.nodes && srcNode.nodes.length > 0) {
				var msg = "要删除的节点是父节点，如果删除将连同子节点一起删掉。\n\n请确认！";
				if (confirm(msg)==true){
					zTree1.removeNode(srcNode);
				}
			} else {
				zTree1.removeNode(srcNode);
			}
		}	
		getNodes();
	}

	function moveTreeNode() {
		if (srcLiId && targetLiId) {
			zTree1.moveNode(targetNode, srcNode);
		}	
		getNodes();
	}

	function getNodes() {
		if (zTree1) {
			var nodes = zTree1.getNodes();
			$("#srcList").html("");
			$("#targetList").html("");
			$("#srcList").append("<li id='demo_Root_srcList' style='line-height:20px;' onclick='selectNode(\"srcList\", this.id, null)'>根 Root</li>");
			$("#targetList").append("<li id='demo_Root_targetList' style='line-height:20px;' onclick='selectNode(\"targetList\", this.id, null)'>根 Root</li>");
			getNodesList("srcList", nodes);
			getNodesList("targetList", nodes);

			if (srcLiId && $("#" + srcLiId).length>0) {
				$("#" + srcLiId).addClass("selectLi");
			} else {
				srcLiId = null;
				srcNode = null;
			}
			if (targetLiId) {
				$("#" + targetLiId).addClass("selectLi");
			} else {
				targetLiId = null;
				targetNode = null;			
			}
			
			
		}
	}

	function getNodesList(nListId, nodes) {
		if (!nodes) return;
		for (var i=0; i<nodes.length ; i++ ) {
			var space = "";
			for (var s = 0; s<nodes[i].level; s++ ) {
				space = space + "--";
			}
			$("#" + nListId).append("<li id='demo_" + nListId + "_" + nodes[i].tId+ "' style='line-height:20px;' onclick='selectNode(\""+ nListId + "\", this.id, \""+ nodes[i].tId + "\")'>" + space + nodes[i].name + "(" + nodes[i].tId + ")" + "</li>");
			getNodesList(nListId, nodes[i].nodes);
		}
	}

	var srcLiId, targetLiId;
	var srcNode, targetNode;
	function selectNode(listId, liId, tId) {
		if (listId == "srcList") {
			var node = zTree1.getNodeByTId(tId);
			if (node) {
				zTree1.selectNode(node);
			}
			srcNode = node;
			if (srcLiId) {
				$("#" + srcLiId).removeClass("selectLi");
			}
			srcLiId = liId;
			$("#" + srcLiId).addClass("selectLi");
		} else {
			if (srcNode && srcNode.tId == tId) {
				alert("目标节点 不能与 操作节点 相同！");
				return;
			}
			var node = zTree1.getNodeByTId(tId);
			targetNode = node;
			if (targetLiId) {
				$("#" + targetLiId).removeClass("selectLi");
			}
			targetLiId = liId;
			$("#" + targetLiId).addClass("selectLi");
		}
	}

  //-->
  </SCRIPT>
 </HEAD>

<BODY>
<center style="margin:10px"><b>代码 操作 节点演示</b></center>
<TABLE border=0 height=600px>
	<TR>
		<TD width=200px align=left valign=top><div class="treeContent"><ul id="tree1" class="tree"></ul></div></TD>
		<TD width=500px align=left valign=top>
		<TABLE border=0 align=center class="tb1">
			<TR>
				<TD width=250px align=center valign=middle>选择 操作 节点</TD>
				<TD width=250px align=center valign=middle>选择 目标 节点</TD>
			</TR>
			<TR>
				<TD align=left valign=top>
				<div  id="srcList" style="width:250px; height:200px; overflow:auto; cursor:pointer; "></div>
				</TD>
				<TD align=left valign=top>
				<div  id="targetList" style="width:250px; height:200px; overflow:auto; cursor:pointer; "></div>
				</TD>
			</TR>
			<TR>
				<TD colspan=2 align=left valign=top>
				给当前 操作 节点增加子节点：<input type="button" id="addNodeBT" value="增 加" onclick="addNode();"/>
				</TD>
			</TR>
			<TR>
				<TD colspan=2 align=left valign=top>
				删除当前 操作 节点：<input type="button" id="removeNodeBT" value="删 除" onclick="removeTreeNode();"/>
				</TD>
			</TR>
			<TR>
				<TD colspan=2 align=left valign=top>
				将 操作 节点 移动到 目标节点下：<input type="button" id="moveNodeBT" value="移 动" onclick="moveTreeNode();"/>
				</TD>
			</TR>
			<TR>
				<TD colspan=2 align=left valign=top>
				<input type="checkbox" id="sonChk" /> 是否包含子节点
				&nbsp;&nbsp;
				<input type="button" id="expandNodeBT" value="展开操作节点" onclick="expandNode(true);"/>
				&nbsp;&nbsp;
				<input type="button" id="collapseNodeBT" value="折叠操作节点" onclick="expandNode(false);"/>
				</TD>
			</TR>
			<TR>
				<TD colspan=2 align=left valign=top>
				
				<input type="button" id="expandAllBT" value="全部展开" onclick="expandAll(true);"/>
				&nbsp;&nbsp;
				<input type="button" id="collapseAllBT" value="全部折叠" onclick="expandAll(false);"/>
				</TD>
			</TR>
		</TABLE>
		</TD>
	</TR>
</TABLE>
 </BODY>
</HTML>
