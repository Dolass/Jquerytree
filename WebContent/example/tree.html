<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
 <HEAD>
  <TITLE> TREE TEST </TITLE>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="style/zTreeStyle.css" type="text/css">
  <style>
  body{margin:0; padding:0; text-align: center;}
div, p, table, th, td, ol, ul, li, dl, dt, dd, form, fieldset, input, select, textarea{list-style:none; margin:0; padding:0; color:#333; font-size:12px; font-family:dotum, Verdana, Arial, Helvetica, AppleGothic, sans-serif;}

  </style>
  <script type="text/javascript" src="jquery-1.4.2.js"></script>
  <script type="text/javascript" src="jquery-ztree-1.0.js"></script>

  <SCRIPT LANGUAGE="JavaScript">
  <!--
	var zTree,zTree2;
	$(document).ready(function(){

		var zNode = {
			showLine: true,
			checkable: true,
			editable: false,
			async: true,
			asyncUrl: "node.php",  //获取节点数据的URL地址
			asyncParam: ["id", "name"],  //获取节点数据时，必须的数据名称，例如：id、name
			asyncParamOther: ["test","true"], //其它参数 ( key, value 键值对格式)
			root:{ 
				isRoot:true,
				nodes:[]
			}
		};

		zNode.root.nodes =[
			
			{ id:-1,	name:"Main1",	icon:"",	url:"",	target:"targetIframe", open:true,	
				nodes: [
			
					{ "id":0,	"name":"Async异步测试",	"icon":"",	"url":"",	"target":"targetIframe", isParent:true},
					{ "id":1,	"name":"tree1",	"icon":"",	"url":"",	"target":"targetIframe", "open": true,
						nodes: [
							{ "id":11,	"name":"谷歌",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"},
							{ "id":12,	"name":"百度",	"icon":"",	"url":"http://baidu.com",	"target":"targetIframe"},
							{ "id":13,	"name":"百度Folder",	"icon":"",	"url":"http://baidu.com",	"target":"targetIframe",
								nodes: [
									{ "id":131,	"name":"tree131",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"},
									{ "id":132,	"name":"tree132",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"},
									{ "id":133,	"name":"tree133",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"}
								]
							}
						]
					},
					{ "id":2,	"name":"tree2",	"icon":"",	"url":"",	"target":"targetIframe", "open":true,
						nodes: [
							{ "id":21,	"name":"tree21",	"icon":"/img/ico_tree_open.gif",	"url":"http://g.cn",	"target":"targetIframe"},
							{ "id":22,	"name":"tree22",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"},
							{ "id":23,	"name":"tree23",	"icon":"",	"url":"",	"target":"targetIframe",
								nodes: [
									{ "id":231,	"name":"tree231",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"},
									{ "id":232,	"name":"tree232",	"icon":"",	"url":"",	"target":"targetIframe",	
										nodes: [
											{ "id":2321,	"name":"tree2321",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"},
											{ "id":2322,	"name":"tree2322",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"},
											{ "id":2323,	"name":"tree2323",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"}
										]
									},
									{ "id":233,	"name":"tree233",	"icon":"",	"url":"http://g.cn",	"target":"targetIframe"}
								]
							}
						]
					}
			
				]
			}
			//,{ "id":-1,	name:"Main1",	"icon":"",	"url":"",	"target":"targetIframe"}
			
		];


		zTree = $("#tree").zTree(clone(zNode));

		var zNode2 = clone(zNode);
		zNode2.check = false;
		zNode2.root.nodes[0].name = "Main2";

		zTree2 = $("#tree2").zTree(zNode2);


		//alert(zTree.getZTreeNode("tree")[1].isParent + "," + zTree.getZTreeNode("tree")[2].isParent);

	});

	var lastTreeNode;
	function zTreeOnClick(event, treeId, treeNode) {
		lastTreeNode = treeNode
		$("#lastClickNode").html("treeId=" + treeId + ";  tId=" + treeNode.tId + "; Name=" + treeNode.name);
	}

	function zTreeOnCheck(event, treeId, treeNode) {
		$("#lastCheckNode").html("treeId=" + treeId + ";  tId=" + treeNode.tId + "; Name=" + treeNode.name + "; Checked=" + treeNode.checkedNew);
	}

	function zTreeOnDrag(event, treeId, treeNode) {
		$("#dragNode").html("treeId=" + treeId + ";  tId=" + treeNode.tId + "; Name=" + treeNode.name);
	}

	function zTreeOnDrop(event, treeId, treeNode, targetNode) {
		if (treeNode) {
				$("#dropNode").html("treeId=" + treeId + ";  tId=" + treeNode.tId + "; Name=" + treeNode.name + "  Target:" + ((targetNode != null) ? targetNode.name : "root"));
		} else {
				$("#dropNode").html("treeId=" + treeId + ";  拖拽放弃。");
		}
	}

	function zTreeOnAsyncSuccess(event, treeId, msg) {
		$("#asyncStatus").html("treeId=" + treeId + ";  ZTREE_AJAX_SUCCESS");
	}
	function zTreeOnAsyncError(event, treeId, XMLHttpRequest, textStatus, errorThrown) {
		$("#asyncStatus").html("treeId=" + treeId + ";  ZTREE_AJAX_ERROR");
	}

	function eidtTree() {
		zTree.setEditable(true);
		zTree2.setEditable(true);
		$("#editTreeBT").attr("disabled", "disabled");
		$("#browseTreeBT").removeAttr("disabled");
	}
	function browseTree(treeId) {
		zTree.setEditable(false);
		zTree2.setEditable(false);
		$("#editTreeBT").removeAttr("disabled");
		$("#browseTreeBT").attr("disabled", "disabled");
	}

	function expandAll(expandSign) {
		zTree.expandAll(expandSign);
	}

	function expandNode(lastTreeNode, expandSign) {
		zTree.expandNode(lastTreeNode, expandSign, $("#sonChk").attr("checked"));
	}

	function selectNode() {
		treeNode = zTree.getCurNode();
		if (treeNode) zTree.selectNode(treeNode.parentNode);
	}

	var addCount = 1;
	function addNode(lastTreeNode) {
		zTree.addNodes(lastTreeNode, [{ "id":0,	"name":"增加" + (addCount++),	"icon":"",	"url":"",	"target":"targetIframe", isParent:true}]);
	}

	function removeTreeNode() {
		treeNode = zTree.getCurNode();
		alert(treeNode);
		if (treeNode) zTree.removeNode(treeNode);
	}

function clone(jsonObj) {
    var buf;
    if (jsonObj instanceof Array) {
        buf = [];
        var i = jsonObj.length;
        while (i--) {
            buf[i] = clone(jsonObj[i]);
        }
        return buf;
    }else if (jsonObj instanceof Object){
        buf = {};
        for (var k in jsonObj) {
            buf[k] = clone(jsonObj[k]);
        }
        return buf;
    }else{
        return jsonObj;
    }
} 

  //-->
  </SCRIPT>
 </HEAD>

 <BODY style="background-color: white" id="body">
	<TABLE border=1 id="xxxTable">
	<TR>
		<TD width="300px" height="200px" align=left>
			<li style="height:30px" >ZTree 状态数据：</li>
			<li style="height:30px" >
				<input type="button" id="editTreeBT" value="编辑" onclick="eidtTree();"  />
				&nbsp;&nbsp;
				<input type="button" id="browseTreeBT" value="浏览" onclick="browseTree();" disabled/>
			</li>
			<li style="height:30px" >
				<input type="button" id="expandAllBT" value="全部展开" onclick="expandAll(true);"/>
				&nbsp;&nbsp;
				<input type="button" id="collapseAllBT" value="全部折叠" onclick="expandAll(false);"/>
			</li>
			<li style="height:30px; padding-top:4px; border-top:1px #FFB951 dotted;" >最后点击的节点：<a id="lastClickNode"></a></li>
			<li style="height:30px" >增加子节点：<input type="button" id="addNodeBT" value="确定" onclick="addNode(lastTreeNode);"/></li>
			<li style="height:30px" >删除当前选择的节点：<input type="button" id="removeNodeBT" value="确定" onclick="removeTreeNode();"/></li>
			<li style="height:30px" >设置当前节点的父节点为选中状态：<input type="button" id="selectNodeBT" value="确定" onclick="selectNode();"/></li>
			<li style="height:30px; margin-bottom:4px; border-bottom:1px #FFB951 dotted; " >
			    <input type="checkbox" id="sonChk" /> 是否包含子节点
				&nbsp;&nbsp;
				<input type="button" id="expandNodeBT" value="展开" onclick="expandNode(lastTreeNode, true);"/>
				&nbsp;&nbsp;
				<input type="button" id="collapseNodeBT" value="折叠" onclick="expandNode(lastTreeNode, false);"/>
			</li>
			<li style="height:30px" >最后选择的节点：<a id="lastCheckNode"></a></li>
			<li style="height:30px" >拖拽的源节点：<a id="dragNode"></a></li>
			<li style="height:30px" >拖拽的目标节点：<a id="dropNode"></a></li>
			<li style="height:30px" >Async状态：<a id="asyncStatus"></a></li>

			<li style="height:30px" id="xxx"></li>
		</TD>
		<TD  width="200px" align=left valign=top><ul id="tree" class="tree" style="width:300px; overflow:auto;"></ul></TD>
		<TD align=center width="500px">测试目标IFRAME:<br /><IFRAME ID="targetIframe" Name="targetIframe" FRAMEBORDER=1 SCROLLING=NO width=90%  height="300px" SRC=""></IFRAME></TD>
	</TR>
	</TABLE>
	
	<ul id="tree2" class="tree" style="width:300px; overflow:auto;"></ul>

 </BODY>
</HTML>
